(function(){"use strict";var e={8676:function(e,t,a){var n=a(9242),r=a(3396);function o(e,t,a,n,o,i){const s=(0,r.up)("HelloWorld");return(0,r.wg)(),(0,r.j4)(s,{msg:"Welcome to Your Vue.js App"})}var i=a(7139);const s={class:"section"},l={class:"container"},c=(0,r._)("div",{class:""},[(0,r._)("p",{class:"title"},"塔克鼠美术馆")],-1),u={class:"column is-full field mb-1"},h={key:0,class:"has-text-grey column mt-1 mb-2"},g={class:"section"},d={class:"container"},p={key:0,class:"columns is-multiline"},m={class:"card mt-4"},f={class:"card-image"},y={class:"image"},b=["href","data-caption"],k=["src","alt"],v={class:"content mt-3"},P={class:"subtitle is-6"},C={class:"subtitle is-6"},w={key:1},_={class:"section"},x={class:"column is-justify-content-center"};function D(e,t,a,n,o,D){const T=(0,r.up)("SearchComponent"),S=(0,r.up)("PaginationComponent");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("section",s,[(0,r._)("div",l,[c,(0,r._)("div",u,[(0,r.Wm)(T,{eraOptions:o.eraOptions,top20Tags:o.top20Tags,onEraChanged:D.handleEraChange,onEnterKeyup:D.handleEnter,onFilterData:D.doSearch,onCheckboxChanged:D.handleCheckboxChange,onTagQuery:D.handleTagQuery},null,8,["eraOptions","top20Tags","onEraChanged","onEnterKeyup","onFilterData","onCheckboxChanged","onTagQuery"])]),o.dataLoaded&&o.dataContent.length>0?((0,r.wg)(),(0,r.iD)("div",h," 找到 "+(0,i.zw)(o.dataContent.length)+" 件艺术品 ",1)):(0,r.kq)("",!0)])]),(0,r._)("section",g,[(0,r._)("div",d,[o.dataLoaded?((0,r.wg)(),(0,r.iD)("div",p,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(D.paginatedData,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e.title,class:"column is-full-mobile is-4-tablet is-3-desktop"},[(0,r._)("div",m,[(0,r._)("div",f,[(0,r._)("figure",y,[(0,r._)("a",{href:e.bigImageUrl,"data-fancybox":"gallery","data-caption":e.title+"<br>"+e.dimension+"<br>"+e.location},[e.imageUrl?((0,r.wg)(),(0,r.iD)("img",{key:0,src:e.imageUrl,alt:e.title},null,8,k)):(0,r.kq)("",!0)],8,b)])])]),(0,r._)("div",v,[(0,r._)("h6",null,(0,i.zw)(e.title_zh||e.title),1),(0,r._)("p",P,(0,i.zw)(e.artist+","+e.year)+"年",1),(0,r._)("p",C,(0,i.zw)(e.museum),1)])])))),128))])):((0,r.wg)(),(0,r.iD)("div",w,"em....世界名画被偷走了，追踪中..."))])]),(0,r._)("section",_,[(0,r._)("div",x,[D.totalPages>1?((0,r.wg)(),(0,r.j4)(S,{key:0,"current-page":o.currentPage,"total-pages":D.totalPages,onPageChanged:D.changePage},null,8,["current-page","total-pages","onPageChanged"])):(0,r.kq)("",!0)])])],64)}var T=a(1076),S=a(6645),O=a(4731);const E={class:"pagination is-rounded",role:"navigation","aria-label":"pagination"},j={class:"pagination-list"},M={key:0},U=(0,r._)("span",{class:"pagination-ellipsis"},"…",-1),N=[U],$=["onClick","aria-label"],z={key:1},A=(0,r._)("span",{class:"pagination-ellipsis"},"…",-1),q=[A],H={key:2},K=["aria-label"];function L(e,t,a,n,o,s){return(0,r.wg)(),(0,r.iD)("nav",E,[(0,r._)("ul",j,[(0,r._)("li",null,[(0,r._)("a",{class:(0,i.C_)(["pagination-link",{"is-current":1===a.currentPage}]),onClick:t[0]||(t[0]=e=>s.changePage(1)),"aria-label":"Goto page 1"},"1",2)]),a.currentPage>3?((0,r.wg)(),(0,r.iD)("li",M,N)):(0,r.kq)("",!0),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.pagesToShow,(e=>((0,r.wg)(),(0,r.iD)("li",{key:e},[(0,r._)("a",{class:(0,i.C_)(["pagination-link",{"is-current":e===a.currentPage}]),onClick:t=>s.changePage(e),"aria-label":"Goto page "+e},(0,i.zw)(e),11,$)])))),128)),a.currentPage<a.totalPages-2?((0,r.wg)(),(0,r.iD)("li",z,q)):(0,r.kq)("",!0),a.totalPages>1?((0,r.wg)(),(0,r.iD)("li",H,[(0,r._)("a",{class:(0,i.C_)(["pagination-link",{"is-current":a.currentPage===a.totalPages}]),onClick:t[1]||(t[1]=e=>s.changePage(a.totalPages)),"aria-label":"Goto page "+a.totalPages},(0,i.zw)(a.totalPages),11,K)])):(0,r.kq)("",!0)])])}a(560);var W={name:"PaginationComponent",props:{currentPage:Number,totalPages:Number},methods:{changePage(e){this.$emit("page-changed",e)}},computed:{pagesToShow(){let e=[],t=Math.max(this.currentPage-2,2),a=Math.min(t+4,this.totalPages-1);1===this.currentPage&&(t=2,a=Math.min(6,this.totalPages-1)),this.currentPage===this.totalPages&&(a=this.totalPages-1,t=Math.max(this.totalPages-5,2));for(let n=t;n<=a;n++)e.push(n);return e}}},Y=a(89);const Z=(0,Y.Z)(W,[["render",L]]);var Q=Z;const V={class:"select"},F=(0,r._)("option",{value:""},"时间/时期",-1),G=["value"],I={class:"control"},R={class:"control"},J={class:"column is-three-quarters"},B={class:"checkbox"};function X(e,t,a,o,s,l){return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",V,[(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.eraSelected=e),onChange:t[1]||(t[1]=t=>e.$emit("era-changed",s.eraSelected))},[F,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.eraOptions,((e,t)=>((0,r.wg)(),(0,r.iD)("option",{key:t,value:t},(0,i.zw)(t)+" ("+(0,i.zw)(e)+") ",9,G)))),128))],544),[[n.bM,s.eraSelected]])]),(0,r._)("div",I,[(0,r.wy)((0,r._)("input",{class:"input",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>s.searchText=e),onKeyup:t[3]||(t[3]=(0,n.D2)((t=>e.$emit("enter-keyup",{searchText:s.searchText,eraSelected:s.eraSelected})),["enter"])),placeholder:"作品关键词"},null,544),[[n.nr,s.searchText]])]),(0,r._)("div",R,[(0,r._)("a",{class:"button is-info",onClick:t[4]||(t[4]=t=>e.$emit("filter-data",{searchText:s.searchText,eraSelected:s.eraSelected}))},"搜索")]),(0,r._)("div",J,[(0,r._)("label",B,[(0,r.wy)((0,r._)("input",{type:"checkbox",onChange:t[5]||(t[5]=t=>e.$emit("checkbox-changed",s.isChecked)),"onUpdate:modelValue":t[6]||(t[6]=e=>s.isChecked=e)},null,544),[[n.e8,s.isChecked]]),(0,r.Uk)(" 精选馆藏 ")])])],64)}var ee={name:"SearchComponent",props:["eraOptions"," "],data(){return{searchText:"",isChecked:!1,eraSelected:""}}};const te=(0,Y.Z)(ee,[["render",X]]);var ae=te,ne={name:"MyComponent",components:{SearchComponent:ae,PaginationComponent:Q},methods:{doSearch(e){this.dataContent=e?this.allData.filter((t=>this.checkEra(t.year,e.eraSelected)&&(!e.searchText||String(t.title).toLowerCase().includes(e.searchText.toLowerCase())))):this.allData},handleCheckboxChange(e){this.dataContent=e?this.allData.filter((e=>1==e.isHighlight)):this.allData},handleEraChange(e){this.dataContent=e?this.allData.filter((t=>this.checkEra(t.year,e))):this.allData},museumchange(e){this.dataContent=e?this.allData.filter((t=>this.checkEra(t.museum,e))):this.allData},handleTagQuery(e){this.dataContent=this.allData.filter((t=>String(t.title).toLowerCase().includes(e.toLowerCase())))},checkEra(e,t){if(!t)return!0;const[a,n]=t.split("-").map(Number);return e>=a&&e<=n},getUniqueYears(e){const t=new Set;return e.forEach((e=>{e.year&&t.add(e.year)})),Array.from(t)},handleEnter(e){this.doSearch(e)},changePage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e)},shuffleArray(e){for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e},calcTop20Tag(){console.log("split word: "+this.allArtWorkNames);const e=this.allArtWorkNames.split(/\s+/),t={};e.forEach((e=>{e in t?t[e]++:t[e]=1})),this.top20Tags=Object.entries(t).sort(((e,t)=>t[1]-e[1])).slice(0,20).map((e=>e[0])),console.log(`top20tags:${this.top20Tags}`)},nplProcess(){let e=(0,S.Z)(this.allArtWorkNames),t=[...e.nouns().out("array"),...e.verbs().out("array"),...e.adjectives().out("array")],a=t.reduce(((e,t)=>(e[t]=e[t]?e[t]+1:1,e)),{});this.top20Tags=Object.entries(a).sort(((e,t)=>t[1]-e[1])).slice(0,20).map((e=>e[0]))},calcEra(e){return isNaN(e)?null:`${100*Math.floor(e/100)}-${100*Math.floor(e/100)+100}`}},computed:{totalPages(){return Math.ceil(this.dataContent.length/this.itemsPerPage)},paginatedData(){const e=(this.currentPage-1)*this.itemsPerPage;return this.dataContent.slice(e,e+this.itemsPerPage)}},data(){return{allData:[],dataContent:[],dataLoaded:!1,currentPage:1,itemsPerPage:32,eraOptions:{},allArtWorkNames:"",top20Tags:[]}},created(){T.Z.get("artworks.json").then((e=>{const t=this.shuffleArray(e.data),a={},n=t.filter((e=>{if(!e.imageUrl)return!1;e.imageUrl=e.imageUrl.replace(/(100px|150px|200px|128px)(?=[^/]*$)/,"300px"),e.bigImageUrl=e.imageUrl.replace(/(100px|150px|200px|128px)(?=[^/]*$)/,"1000px");const t=this.calcEra(parseInt(e.year));return t&&(a[t]=(a[t]||0)+1),!0}));let r={};Object.keys(a).forEach((e=>{a[e]>=10&&(r[e]=a[e])})),this.eraOptions=r,this.allData=n,this.doSearch(),this.dataLoaded=!0,O.KR.bind("[data-fancybox]",{Thumbs:{showOnStart:!1}}),O.KR.Thumbs=!1})).catch((e=>{console.error("Error reading the JSON file",e)}))}};const re=(0,Y.Z)(ne,[["render",D]]);var oe=re,ie={name:"App",components:{HelloWorld:oe}};const se=(0,Y.Z)(ie,[["render",o]]);var le=se;document.title="塔克鼠美术馆",(0,n.ri)(le).mount("#app")}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,n,r,o){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],o=e[u][2];for(var s=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(a.O).every((function(e){return a.O[e](n[l])}))?n.splice(l--,1):(s=!1,o<i&&(i=o));if(s){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,o,i=n[0],s=n[1],l=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);if(l)var u=l(a)}for(t&&t(n);c<i.length;c++)o=i[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},n=self["webpackChunktakeshu"]=self["webpackChunktakeshu"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(8676)}));n=a.O(n)})();
//# sourceMappingURL=app.665c0e22.js.map